var gdjs;(function(r){class n extends r.CustomRuntimeObject{constructor(t,e){super(t,e);this._z=0;this._minZ=0;this._maxZ=0;this._scaleZ=1;this._flippedZ=!1;this._rotationX=0;this._rotationY=0;this._customCenterZ=0}_createRender(){const t=this._runtimeScene;return new r.CustomRuntimeObject3DRenderer(this,this._instanceContainer,t)}_reinitializeRenderer(){this.getRenderer().reinitialize(this,this.getParent())}getRenderer(){return super.getRenderer()}get3DRendererObject(){return this.getRenderer().get3DRendererObject()}extraInitializationFromInitialInstance(t){super.extraInitializationFromInitialInstance(t),t.depth!==void 0&&this.setDepth(t.depth),this.flipX(!!t.flippedX),this.flipY(!!t.flippedY),this.flipZ(!!t.flippedZ)}getNetworkSyncData(t){return{...super.getNetworkSyncData(t),z:this.getZ(),d:this.getDepth(),rx:this.getRotationX(),ry:this.getRotationY(),ifz:this.isFlippedZ(),ccz:this._customCenterZ}}updateFromNetworkSyncData(t,e){super.updateFromNetworkSyncData(t,e),t.z!==void 0&&this.setZ(t.z),t.d!==void 0&&this.setDepth(t.d),t.rx!==void 0&&this.setRotationX(t.rx),t.ry!==void 0&&this.setRotationY(t.ry),t.ifz!==void 0&&this.flipZ(t.ifz),t.ccz!==void 0&&(this._customCenterZ=t.ccz)}setZ(t){t!==this._z&&(this._z=t,this.getRenderer().updatePosition())}getZ(){return this._z}getDrawableZ(){let t=0;this._innerArea?t=this._innerArea.min[2]:(this._isUntransformedHitBoxesDirty&&this._updateUntransformedHitBoxes(),t=this._minZ);const e=this.getScaleZ();return this._flippedZ?this._z+(-t-this.getUnscaledDepth()+2*this.getUnscaledCenterZ())*e:this._z+t*e}getCenterZ(){return this.getDepth()/2}getCenterZInScene(){return this.getDrawableZ()+this.getCenterZ()}setCenterZInScene(t){this.setZ(t+this._z-(this.getDrawableZ()+this.getCenterZ()))}getUnrotatedAABBMinZ(){return this.getDrawableZ()}getUnrotatedAABBMaxZ(){return this.getDrawableZ()+this.getDepth()}setRotationX(t){this._rotationX=t,this.getRenderer().updateRotation()}setRotationY(t){this._rotationY=t,this.getRenderer().updateRotation()}getRotationX(){return this._rotationX}getRotationY(){return this._rotationY}turnAroundX(t){const e=r.CustomRuntimeObject3D._temporaryVector;e.set(1,0,0);const i=this.get3DRendererObject();i.rotateOnWorldAxis(e,r.toRad(t)),this._rotationX=r.toDegrees(i.rotation.x),this._rotationY=r.toDegrees(i.rotation.y),this.setAngle(r.toDegrees(i.rotation.z))}turnAroundY(t){const e=r.CustomRuntimeObject3D._temporaryVector;e.set(0,1,0);const i=this.get3DRendererObject();i.rotateOnWorldAxis(e,r.toRad(t)),this._rotationX=r.toDegrees(i.rotation.x),this._rotationY=r.toDegrees(i.rotation.y),this.setAngle(r.toDegrees(i.rotation.z))}turnAroundZ(t){const e=r.CustomRuntimeObject3D._temporaryVector;e.set(0,0,1);const i=this.get3DRendererObject();i.rotateOnWorldAxis(e,r.toRad(t)),this._rotationX=r.toDegrees(i.rotation.x),this._rotationY=r.toDegrees(i.rotation.y),this.setAngle(r.toDegrees(i.rotation.z))}getInnerAreaMinZ(){return this._innerArea?this._innerArea.min[2]:(this._isUntransformedHitBoxesDirty&&this._updateUntransformedHitBoxes(),this._minZ)}getInnerAreaMaxZ(){return this._innerArea?this._innerArea.max[2]:(this._isUntransformedHitBoxesDirty&&this._updateUntransformedHitBoxes(),this._maxZ)}getUnscaledDepth(){return this._innerArea?this._innerArea.max[2]-this._innerArea.min[2]:(this._isUntransformedHitBoxesDirty&&this._updateUntransformedHitBoxes(),this._maxZ-this._minZ)}getOriginalDepth(){return this._instanceContainer._getInitialInnerAreaDepth()}_updateUntransformedHitBoxes(){super._updateUntransformedHitBoxes();let t=Number.MAX_VALUE,e=-Number.MAX_VALUE;for(const i of this._instanceContainer.getAdhocListOfAllInstances())!i.isIncludedInParentCollisionMask()||!r.Base3DHandler.is3D(i)||(t=Math.min(t,i.getUnrotatedAABBMinZ()),e=Math.max(e,i.getUnrotatedAABBMaxZ()));t===Number.MAX_VALUE&&(t=0,e=1),this._minZ=t,this._maxZ=e}getUnscaledCenterZ(){return this.hasCustomRotationCenter()?this._customCenterZ:this._innerArea?(this._innerArea.min[2]+this._innerArea.max[2])/2:(this._isUntransformedHitBoxesDirty&&this._updateUntransformedHitBoxes(),(this._minZ+this._maxZ)/2)}setRotationCenter3D(t,e,i){this._customCenterZ=i,this.setRotationCenter(t,e)}getDepth(){return this.getUnscaledDepth()*this.getScaleZ()}setDepth(t){const e=this.getUnscaledDepth();if(e===0)return;const i=t/e;this._innerArea&&this._isInnerAreaFollowingParentSize?(this._innerArea.min[2]*=i,this._innerArea.max[2]*=i):this.setScaleZ(i)}setScale(t){super.setScale(t),this.setScaleZ(t)}setScaleZ(t){this._innerArea&&this._isInnerAreaFollowingParentSize||(t<0&&(t=0),t!==Math.abs(this._scaleZ)&&(this._scaleZ=t*(this._flippedZ?-1:1),this.getRenderer().updateSize()))}getScale(){const t=this.getScaleX(),e=this.getScaleY(),i=this.getScaleZ();return t===e&&t===i?t:Math.pow(t*e*i,1/3)}getScaleZ(){return Math.abs(this._scaleZ)}flipZ(t){t!==this._flippedZ&&(this._flippedZ=t,this.getRenderer().updateSize())}isFlippedZ(){return this._flippedZ}}n._temporaryVector=new THREE.Vector3,r.CustomRuntimeObject3D=n})(gdjs||(gdjs={}));
//# sourceMappingURL=CustomRuntimeObject3D.js.map
